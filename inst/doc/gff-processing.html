<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Zebulun Arendsee" />


<title>Case Study: GFF processing</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; position: absolute; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; }
pre.numberSource a.sourceLine:empty
  { position: absolute; }
pre.numberSource a.sourceLine::before
  { content: attr(data-line-number);
    position: absolute; left: -5em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>

</head>

<body>




<h1 class="title toc-ignore">Case Study: GFF processing</h1>
<h4 class="author"><em>Zebulun Arendsee</em></h4>



<p>This work is funded by the National Science Foundation grant <a href="https://www.nsf.gov/awardsearch/showAward?AWD_ID=1546858">NSF-IOS 1546858</a>.</p>
<div id="the-problem" class="section level2">
<h2>The problem</h2>
<p>Gene Feature Format (GFF) is used to annotate intervals on a genome. Loading and validating a GFF is a common first step in a bioinformatics analysis. Mistakes at this step can cause major problems later, so it is important to validate the GFF and report good diagnostics when problems arise. Here I will show how such a pipeline can be written using standard methods, and then show how <code>rmonad</code> can be used to organize and annotate such a pipeline.</p>
<p>GFF files are TAB-delimited where each row corresponds to a single interval. These intervals, though, may be ontologically related. For example a gene is the parent of an mRNA, which in turn is a parent of a set of exons and a set of coding sequences (CDS). These relations are specified in the attribute column (column 9). Here is an example (with TABs replaced with space) that introduces the main format and the variants we need to support:</p>
<pre><code># this is a comment, they can appear anywhere in the GFF
# also note, empty lines can appear anywhere in the file

# This is a simple mono-exonic gene
I   .   gene   11565   11951   .   -   .   ID=gene0
I   .   mRNA   11565   11951   .   -   .   ID=mrna0;Parent=gene0
I   .   exon   11565   11951   .   -   .   Parent=mrna0
I   .   CDS    11565   11951   .   -   0   Parent=mrna0

# this is a gene with two splicing variants:
I   .   gene   61931   83591   .   +   .   ID=gene1

I   .   mRNA   61931   83591   .   +   .   ID=rna1;Parent=gene1
I   .   exon   61931   62344   .   +   .   Parent=rna1
I   .   exon   81616   82209   .   +   .   Parent=rna1
I   .   exon   82211   83591   .   +   .   Parent=rna1
I   .   CDS   61931   62344   .   +   0   Parent=rna1
I   .   CDS   81616   82209   .   +   0   Parent=rna1
I   .   CDS   82211   82681   .   +   0   Parent=rna1

I   .   mRNA   61931   83591   .   +   .   ID=rna2;Parent=gene1
I   .   exon   61931   62344   .   +   .   Parent=rna2
I   .   exon   81616   82209   .   +   .   Parent=rna2
I   .   exon   82211   83591   .   +   .   Parent=rna2
I   .   CDS   61931   62344   .   +   0   Parent=rna2
I   .   CDS   82211   82681   .   +   0   Parent=rna2

# Below are a few variants that occur (unforunately) in the wild

# V1: CDS directly descending from a gene.
b   .   gene   7235   9016   .   -   .   ID=gene2
b   .   CDS    7235   9016   .   -   0   Parent=gene2

# V2: 'Parent=-' when feature has no parent
I   .   gene   11565   11951   .   -   .   ID=gene3;Parent=-

# V3: Elements with no tags that need to be treated as IDs
I   .   gene   11565   11951   .   -   .   gene3
I   .   mRNA   11565   11951   .   -   .   ID=mrna3;Parent=gene3
I   .   exon   11565   11951   .   -   .   Parent=mrna3
I   .   CDS    11565   11951   .   -   0   Parent=mrna3</code></pre>
<p>Another issues we need to account for is type synonyms. The feature type (column 3) is required to be valid Sequence Ontology (SO) terms. For the purposes of this vignette, I will just handle the following sets of synonyms:</p>
<ul>
<li><p>gene := <code>gene</code> | <code>SO:0000704</code></p></li>
<li><p>mRNA := <code>mRNA</code> | <code>messenger RNA</code> | <code>messenger_RNA</code> | <code>SO:0000234</code> | <code>transcript</code> | <code>SO:0000673</code></p></li>
<li><p>CDS := <code>CDS</code> | <code>coding_sequence</code> | <code>coding sequence</code> | <code>SO:0000316</code></p></li>
<li><p>exon := <code>exon</code> | <code>SO:0000147</code> | <code>coding_exon</code> | <code>coding exon</code> |<code>SO:0000195</code></p></li>
</ul>
<p>For mRNA and exon, I am merging to ontology terms (mRNA and transcript; exon and coding exon). Formally, this is incorrect, but pratically it is probably the right thing. Since these transformations may be wrong, they need to be noted.</p>
</div>
<div id="solution" class="section level2">
<h2>Solution</h2>
<p>To test our solution, I use the <code>gff</code> rmonad dataset.</p>
<div id="conventional-approach" class="section level3">
<h3>Conventional approach</h3>
<p>Before using <code>rmonad</code>, I will use a more conventional approach.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1"><span class="kw">library</span>(readr)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2"><span class="kw">library</span>(dplyr)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw">library</span>(tidyr)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="kw">library</span>(magrittr)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'magrittr'</code></pre>
<pre><code>## The following object is masked from 'package:tidyr':
## 
##     extract</code></pre>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">210</span>)</a>
<a class="sourceLine" id="cb9-2" data-line-number="2"></a>
<a class="sourceLine" id="cb9-3" data-line-number="3">good_gfffile &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'gff'</span>, <span class="st">'0.gff3'</span>, <span class="dt">package=</span><span class="st">'rmonad'</span>)</a>
<a class="sourceLine" id="cb9-4" data-line-number="4"></a>
<a class="sourceLine" id="cb9-5" data-line-number="5">read_gff &lt;-<span class="st"> </span><span class="cf">function</span>(file){</a>
<a class="sourceLine" id="cb9-6" data-line-number="6">  readr<span class="op">::</span><span class="kw">read_tsv</span>(</a>
<a class="sourceLine" id="cb9-7" data-line-number="7">    file,</a>
<a class="sourceLine" id="cb9-8" data-line-number="8">    <span class="dt">col_names =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb9-9" data-line-number="9">        <span class="st">&quot;seqid&quot;</span>,</a>
<a class="sourceLine" id="cb9-10" data-line-number="10">        <span class="st">&quot;source&quot;</span>,</a>
<a class="sourceLine" id="cb9-11" data-line-number="11">        <span class="st">&quot;type&quot;</span>,</a>
<a class="sourceLine" id="cb9-12" data-line-number="12">        <span class="st">&quot;start&quot;</span>,</a>
<a class="sourceLine" id="cb9-13" data-line-number="13">        <span class="st">&quot;stop&quot;</span>,</a>
<a class="sourceLine" id="cb9-14" data-line-number="14">        <span class="st">&quot;score&quot;</span>,</a>
<a class="sourceLine" id="cb9-15" data-line-number="15">        <span class="st">&quot;strand&quot;</span>,</a>
<a class="sourceLine" id="cb9-16" data-line-number="16">        <span class="st">&quot;phase&quot;</span>,</a>
<a class="sourceLine" id="cb9-17" data-line-number="17">        <span class="st">&quot;attr&quot;</span></a>
<a class="sourceLine" id="cb9-18" data-line-number="18">    ),</a>
<a class="sourceLine" id="cb9-19" data-line-number="19">    <span class="dt">na        =</span> <span class="st">&quot;.&quot;</span>,</a>
<a class="sourceLine" id="cb9-20" data-line-number="20">    <span class="dt">comment   =</span> <span class="st">&quot;#&quot;</span>,</a>
<a class="sourceLine" id="cb9-21" data-line-number="21">    <span class="dt">col_types =</span> <span class="st">&quot;ccciidcic&quot;</span></a>
<a class="sourceLine" id="cb9-22" data-line-number="22">  )</a>
<a class="sourceLine" id="cb9-23" data-line-number="23">}</a>
<a class="sourceLine" id="cb9-24" data-line-number="24"></a>
<a class="sourceLine" id="cb9-25" data-line-number="25"><span class="kw">read_gff</span>(good_gfffile)</a></code></pre></div>
<pre><code>## # A tibble: 17 x 9
##    seqid source type          start   stop score strand phase attr        
##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;int&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       
##  1 a     Strex  region            1 230218    NA +         NA ID=I        
##  2 a     Strex  telomere          1    801    NA -         NA ID=id1      
##  3 a     Strex  origin_of_re…   707    776    NA +         NA ID=id2      
##  4 a     Strex  gene           1807   2169    NA -         NA ID=gene1    
##  5 a     Strex  mRNA           1807   2169    NA -         NA ID=mrna1;Pa…
##  6 a     Strex  exon           1807   2169    NA -         NA Parent=mrna1
##  7 a     Strex  CDS            1807   2169    NA -          0 Parent=mrna1
##  8 a     Strex  mRNA           2480   2707    NA +         NA ID=mrna2;Pa…
##  9 a     Strex  exon           2480   2707    NA +         NA Parent=mrna2
## 10 a     Strex  CDS            2480   2707    NA +          0 Parent=mrna2
## 11 b     Strex  gene           7235   9016    NA -         NA ID=gene2    
## 12 b     Strex  CDS            7235   9016    NA -          0 Parent=gene2
## 13 b     Strex  origin_of_re…  7997   8547    NA +         NA ID=id6      
## 14 b     Strex  gene          11565  11951    NA -         NA ID=gene3    
## 15 b     Strex  mRNA          11565  11951    NA -         NA ID=mrna3;Pa…
## 16 b     Strex  exon          11565  11951    NA -         NA Parent=mrna3
## 17 b     Strex  CDS           11565  11951    NA -          0 Parent=mrna3</code></pre>
<p>This is a nice start, also, <code>readr</code> will pick up on any deviations from the specified column number and type, warning of problems:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1"><span class="co"># wrong type</span></a>
<a class="sourceLine" id="cb11-2" data-line-number="2">bad0 &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'gff'</span>, <span class="st">'bad-0.gff3'</span>, <span class="dt">package=</span><span class="st">'rmonad'</span>)</a>
<a class="sourceLine" id="cb11-3" data-line-number="3"><span class="kw">read_gff</span>(bad0)</a></code></pre></div>
<pre><code>## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 2)</code></pre>
<pre><code>## Warning: 1 parsing failure.
## row # A tibble: 1 x 5 col     row col   expected   actual                               file         expected   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;                                &lt;chr&gt;        actual 1     4 start an integer one thousand eight hundred and seven '/tmp/Rtmp2… file # A tibble: 1 x 5</code></pre>
<pre><code>## # A tibble: 17 x 9
##    seqid source type          start   stop score strand phase attr        
##    &lt;chr&gt; &lt;chr&gt;  &lt;chr&gt;         &lt;int&gt;  &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;       
##  1 a     Strex  region            1 230218    NA +         NA ID=I        
##  2 a     Strex  telomere          1    801    NA -         NA ID=id1      
##  3 a     Strex  origin_of_re…   707    776    NA +         NA ID=id2      
##  4 a     Strex  gene             NA   2169    NA -         NA ID=gene1    
##  5 a     Strex  mRNA           1807   2169    NA -         NA ID=mrna1;Pa…
##  6 a     Strex  exon           1807   2169    NA -         NA Parent=mrna1
##  7 a     Strex  CDS            1807   2169    NA -          0 Parent=mrna1
##  8 a     Strex  mRNA           2480   2707    NA +         NA ID=mrna2;Pa…
##  9 a     Strex  exon           2480   2707    NA +         NA Parent=mrna2
## 10 a     Strex  CDS            2480   2707    NA +          0 Parent=mrna2
## 11 b     Strex  gene           7235   9016    NA -         NA ID=gene2    
## 12 b     Strex  CDS            7235   9016    NA -          0 Parent=gene2
## 13 b     Strex  origin_of_re…  7997   8547    NA +         NA ID=id6      
## 14 b     Strex  gene          11565  11951    NA -         NA ID=gene3    
## 15 b     Strex  mRNA          11565  11951    NA -         NA ID=mrna3;Pa…
## 16 b     Strex  exon          11565  11951    NA -         NA Parent=mrna3
## 17 b     Strex  CDS           11565  11951    NA -          0 Parent=mrna3</code></pre>
<p>Notice that the 4th entry has a start value of “NA”. This indicates there was something wrong with he gff file and when we take a look at the original gff, we see that the entry corresponds to the string “one thousand eight hundred and seven” instead of the number. While this is not a likely error, it is a similar error for when a number contains a comma (example: “1,807”“) which R will parse as a string.</p>
<pre class="{,eval=false}"><code># incorrect type
a       Strex   region  1       230218  .       +       .       ID=I
a       Strex   telomere        1       801     .       -       .       ID=id1
a       Strex   origin_of_replication   707     776     .       +       .       ID=id2
a       Strex   gene    &quot;one thousand eight hundred and seven&quot;  2169    .       -       .       ID=gene1</code></pre>
<p>Similarly when we load in a gff missing a column.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1"><span class="co"># wrong column number</span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2">bad1 &lt;-<span class="st"> </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'gff'</span>, <span class="st">'bad-1.gff3'</span>, <span class="dt">package=</span><span class="st">'rmonad'</span>)</a>
<a class="sourceLine" id="cb16-3" data-line-number="3"><span class="kw">read_gff</span>(bad1)</a></code></pre></div>
<pre><code>## Warning in rbind(names(probs), probs_f): number of columns of result is not
## a multiple of vector length (arg 1)</code></pre>
<pre><code>## Warning: 51 parsing failures.
## row # A tibble: 5 x 5 col     row col   expected   actual    file                                    expected   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;      &lt;chr&gt;     &lt;chr&gt;                                   actual 1     1 score a double   +         '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmo… file 2     1 phase an integer ID=I      '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmo… row 3     1 &lt;NA&gt;  9 columns  8 columns '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmo… col 4     2 score a double   -         '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmo… expected 5     2 phase an integer ID=id1    '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmo…
## ... ................. ... .......................................................................... ........ .......................................................................... ...... .......................................................................... .... .......................................................................... ... .......................................................................... ... .......................................................................... ........ ..........................................................................
## See problems(...) for more details.</code></pre>
<pre><code>## # A tibble: 17 x 9
##    seqid source                type   start  stop score strand phase attr 
##    &lt;chr&gt; &lt;chr&gt;                 &lt;chr&gt;  &lt;int&gt; &lt;int&gt; &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt;
##  1 a     region                1     230218    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  2 a     telomere              1        801    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  3 a     origin_of_replication 707      776    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  4 a     gene                  1807    2169    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  5 a     mRNA                  1807    2169    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  6 a     exon                  1807    2169    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  7 a     CDS                   1807    2169    NA    NA 0         NA &lt;NA&gt; 
##  8 a     mRNA                  2480    2707    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
##  9 a     exon                  2480    2707    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
## 10 a     CDS                   2480    2707    NA    NA 0         NA &lt;NA&gt; 
## 11 b     gene                  7235    9016    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
## 12 b     CDS                   7235    9016    NA    NA 0         NA &lt;NA&gt; 
## 13 b     origin_of_replication 7997    8547    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
## 14 b     gene                  11565  11951    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
## 15 b     mRNA                  11565  11951    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
## 16 b     exon                  11565  11951    NA    NA &lt;NA&gt;      NA &lt;NA&gt; 
## 17 b     CDS                   11565  11951    NA    NA 0         NA &lt;NA&gt;</code></pre>
<p>The read_gff can correctly identify that a column is missing from the following raw file.</p>
<pre class="{,eval=false}"><code># missing one column
a       region  1       230218  .       +       .       ID=I
a       telomere        1       801     .       -       .       ID=id1
a       origin_of_replication   707     776     .       +       .       ID=id2
a       gene    1807    2169    .       -       .       ID=gene1</code></pre>
<p>R uses <code>NA</code> to indicate missing values. The R ‘numeric’ type corresponds to Haskell <code>[Maybe Num]</code>, i.e. an array of possibly empty values. In a GFF, columns 2,6,7,8 and 9 may be missing, the others may not. So we need an additional assertion that these are complete.</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1">g &lt;-<span class="st"> </span><span class="kw">read_gff</span>(good_gfffile)</a>
<a class="sourceLine" id="cb21-2" data-line-number="2"><span class="cf">for</span>(col <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;seqid&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;stop&quot;</span>)){</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(g[[col]]))){</a>
<a class="sourceLine" id="cb21-4" data-line-number="4">    <span class="kw">stop</span>(<span class="st">&quot;GFFError: Column '&quot;</span>, col, <span class="st">&quot;' may not have missing values&quot;</span>)</a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  }</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">}</a></code></pre></div>
<p>Now we can account for type synonyms using the following method</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">gene_synonyms &lt;-<span class="st"> 'SO:0000704'</span></a>
<a class="sourceLine" id="cb22-2" data-line-number="2">mRNA_synonyms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'messenger_RNA'</span>, <span class="st">'messenger RNA'</span>, <span class="st">'SO:0000234'</span>)</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">CDS_synonyms  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'coding_sequence'</span>, <span class="st">'coding sequence'</span>, <span class="st">'SO:0000316'</span>)</a>
<a class="sourceLine" id="cb22-4" data-line-number="4">exon_synonyms &lt;-<span class="st"> 'SO:0000147'</span></a>
<a class="sourceLine" id="cb22-5" data-line-number="5"></a>
<a class="sourceLine" id="cb22-6" data-line-number="6">g<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>gene_synonyms, <span class="st">'gene'</span>, g<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb22-7" data-line-number="7">g<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>mRNA_synonyms, <span class="st">'mRNA'</span>, g<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb22-8" data-line-number="8">g<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>CDS_synonyms,  <span class="st">'CDS'</span>,  g<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb22-9" data-line-number="9">g<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>exon_synonyms, <span class="st">'exon'</span>, g<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb22-10" data-line-number="10"></a>
<a class="sourceLine" id="cb22-11" data-line-number="11">mRNA_near_synonyms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'transcript'</span>, <span class="st">'SO:0000673'</span>)</a>
<a class="sourceLine" id="cb22-12" data-line-number="12">exon_near_synonyms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'SO:0000147'</span>, <span class="st">'coding_exon'</span>, <span class="st">'coding exon'</span>, <span class="st">'SO:0000195'</span>)</a>
<a class="sourceLine" id="cb22-13" data-line-number="13"></a>
<a class="sourceLine" id="cb22-14" data-line-number="14"><span class="cf">if</span>(<span class="kw">any</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>mRNA_near_synonyms)){</a>
<a class="sourceLine" id="cb22-15" data-line-number="15">    g<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>mRNA_near_synonyms, <span class="st">'mRNA'</span>, g<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb22-16" data-line-number="16">    <span class="kw">warning</span>(<span class="st">&quot;Substituting transcript types for mRNA types, this is probably OK&quot;</span>)</a>
<a class="sourceLine" id="cb22-17" data-line-number="17">}</a>
<a class="sourceLine" id="cb22-18" data-line-number="18"></a>
<a class="sourceLine" id="cb22-19" data-line-number="19"><span class="cf">if</span>(<span class="kw">any</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>exon_near_synonyms)){</a>
<a class="sourceLine" id="cb22-20" data-line-number="20">    g<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(g<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>exon_near_synonyms, <span class="st">'exon'</span>, g<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb22-21" data-line-number="21">    <span class="kw">warning</span>(<span class="st">&quot;Substituting transcript types for exon types, this is probably OK&quot;</span>)</a>
<a class="sourceLine" id="cb22-22" data-line-number="22">}</a></code></pre></div>
<p>Now we need to evaluate the attribute column.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">tags &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Parent&quot;</span>)</a>
<a class="sourceLine" id="cb23-2" data-line-number="2"></a>
<a class="sourceLine" id="cb23-3" data-line-number="3"><span class="kw">data_frame</span>(</a>
<a class="sourceLine" id="cb23-4" data-line-number="4">    <span class="dt">attr  =</span> stringr<span class="op">::</span><span class="kw">str_split</span>(g<span class="op">$</span>attr, <span class="st">&quot;;&quot;</span>),</a>
<a class="sourceLine" id="cb23-5" data-line-number="5">    <span class="dt">order =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(g)</a>
<a class="sourceLine" id="cb23-6" data-line-number="6">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-7" data-line-number="7"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ntags =</span> <span class="kw">sapply</span>(attr, length)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-8" data-line-number="8"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">unnest</span>(attr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-9" data-line-number="9"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">attr =</span> <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">'='</span>, attr), attr, <span class="kw">paste</span>(<span class="st">&quot;.U&quot;</span>, attr, <span class="dt">sep=</span><span class="st">&quot;=&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-10" data-line-number="10"><span class="st">  </span>tidyr<span class="op">::</span><span class="kw">separate_</span>(</a>
<a class="sourceLine" id="cb23-11" data-line-number="11">    <span class="dt">col   =</span> <span class="st">&quot;attr&quot;</span>,</a>
<a class="sourceLine" id="cb23-12" data-line-number="12">    <span class="dt">into  =</span> <span class="kw">c</span>(<span class="st">&quot;tag&quot;</span>, <span class="st">&quot;value&quot;</span>),</a>
<a class="sourceLine" id="cb23-13" data-line-number="13">    <span class="dt">sep   =</span> <span class="st">&quot;=&quot;</span>,</a>
<a class="sourceLine" id="cb23-14" data-line-number="14">    <span class="dt">extra =</span> <span class="st">&quot;merge&quot;</span></a>
<a class="sourceLine" id="cb23-15" data-line-number="15">  ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-16" data-line-number="16"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(tag <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(tags, <span class="st">&quot;.U&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-17" data-line-number="17"><span class="st">  </span>{</a>
<a class="sourceLine" id="cb23-18" data-line-number="18">    <span class="cf">if</span>(<span class="kw">nrow</span>(.) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb23-19" data-line-number="19">      tidyr<span class="op">::</span><span class="kw">spread</span>(., <span class="dt">key=</span><span class="st">&quot;tag&quot;</span>, <span class="dt">value=</span><span class="st">&quot;value&quot;</span>)</a>
<a class="sourceLine" id="cb23-20" data-line-number="20">    } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb23-21" data-line-number="21">      .<span class="op">$</span>tag   =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb23-22" data-line-number="22">      .<span class="op">$</span>value =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb23-23" data-line-number="23">      .</a>
<a class="sourceLine" id="cb23-24" data-line-number="24">    }</a>
<a class="sourceLine" id="cb23-25" data-line-number="25">  } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-26" data-line-number="26"><span class="st">  </span>{</a>
<a class="sourceLine" id="cb23-27" data-line-number="27">    <span class="cf">if</span>(<span class="st">&quot;Parent&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.)){</a>
<a class="sourceLine" id="cb23-28" data-line-number="28">      .<span class="op">$</span>Parent &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>Parent <span class="op">==</span><span class="st"> &quot;-&quot;</span>, <span class="ot">NA</span>, .<span class="op">$</span>Parent)</a>
<a class="sourceLine" id="cb23-29" data-line-number="29">    }</a>
<a class="sourceLine" id="cb23-30" data-line-number="30">    .</a>
<a class="sourceLine" id="cb23-31" data-line-number="31">  } <span class="op">%&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb23-32" data-line-number="32">    <span class="cf">for</span>(tag <span class="cf">in</span> <span class="kw">c</span>(tags, <span class="st">&quot;.U&quot;</span>)){</a>
<a class="sourceLine" id="cb23-33" data-line-number="33">      <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span>tag <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.))</a>
<a class="sourceLine" id="cb23-34" data-line-number="34">        .[[tag]] =<span class="st"> </span><span class="ot">NA_character_</span></a>
<a class="sourceLine" id="cb23-35" data-line-number="35">    }</a>
<a class="sourceLine" id="cb23-36" data-line-number="36">    .</a>
<a class="sourceLine" id="cb23-37" data-line-number="37">  } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-38" data-line-number="38"><span class="st">  </span>{</a>
<a class="sourceLine" id="cb23-39" data-line-number="39">    <span class="cf">if</span>(<span class="st">&quot;ID&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.))</a>
<a class="sourceLine" id="cb23-40" data-line-number="40">      .<span class="op">$</span>ID &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(.<span class="op">$</span>ID) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(.<span class="op">$</span>.U) <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>ntags <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .<span class="op">$</span>.U, .<span class="op">$</span>ID)</a>
<a class="sourceLine" id="cb23-41" data-line-number="41">    .</a>
<a class="sourceLine" id="cb23-42" data-line-number="42">  } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-43" data-line-number="43"><span class="st">  </span><span class="kw">merge</span>(<span class="kw">data_frame</span>(<span class="dt">order=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(g)), <span class="dt">all=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-44" data-line-number="44"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(order) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-45" data-line-number="45"><span class="st">  </span>{ <span class="kw">cbind</span>(g, .) } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-46" data-line-number="46"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>.U, <span class="op">-</span>order, <span class="op">-</span>ntags, <span class="op">-</span>attr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb23-47" data-line-number="47"><span class="st">  </span>{</a>
<a class="sourceLine" id="cb23-48" data-line-number="48">    <span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Parent&quot;</span>) <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.))){</a>
<a class="sourceLine" id="cb23-49" data-line-number="49">      parents &lt;-<span class="st"> </span><span class="kw">subset</span>(., type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CDS&quot;</span>, <span class="st">&quot;exon&quot;</span>))<span class="op">$</span>Parent</a>
<a class="sourceLine" id="cb23-50" data-line-number="50">      parent_types &lt;-<span class="st"> </span><span class="kw">subset</span>(., ID <span class="op">%in%</span><span class="st"> </span>parents)<span class="op">$</span>type</a>
<a class="sourceLine" id="cb23-51" data-line-number="51"></a>
<a class="sourceLine" id="cb23-52" data-line-number="52">      <span class="cf">if</span>(<span class="kw">any</span>(parent_types <span class="op">==</span><span class="st"> &quot;gene&quot;</span>))</a>
<a class="sourceLine" id="cb23-53" data-line-number="53">        <span class="kw">warning</span>(<span class="st">&quot;Found CDS or exon directly inheriting from a gene, this may be fine.&quot;</span>) </a>
<a class="sourceLine" id="cb23-54" data-line-number="54"></a>
<a class="sourceLine" id="cb23-55" data-line-number="55">      <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span><span class="kw">all</span>(parent_types <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>, <span class="st">&quot;mRNA&quot;</span>)))</a>
<a class="sourceLine" id="cb23-56" data-line-number="56">        <span class="kw">stop</span>(<span class="st">&quot;Found CDS or exon with illegal parent&quot;</span>)</a>
<a class="sourceLine" id="cb23-57" data-line-number="57"></a>
<a class="sourceLine" id="cb23-58" data-line-number="58">      <span class="cf">if</span>( <span class="kw">any</span>(<span class="kw">is.na</span>(parents)) )</a>
<a class="sourceLine" id="cb23-59" data-line-number="59">        <span class="kw">stop</span>(<span class="st">&quot;Found CDS or exon with no parent&quot;</span>)</a>
<a class="sourceLine" id="cb23-60" data-line-number="60"></a>
<a class="sourceLine" id="cb23-61" data-line-number="61">      <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span><span class="kw">any</span>(<span class="kw">duplicated</span>(.<span class="op">$</span>ID, <span class="dt">incomparables=</span><span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb23-62" data-line-number="62">        <span class="kw">warning</span>(<span class="st">&quot;IDs are not unique, this is probably bad&quot;</span>)</a>
<a class="sourceLine" id="cb23-63" data-line-number="63">    }</a>
<a class="sourceLine" id="cb23-64" data-line-number="64">    .</a>
<a class="sourceLine" id="cb23-65" data-line-number="65">  }</a></code></pre></div>
<pre><code>## Warning in function_list[[k]](value): Found CDS or exon directly inheriting
## from a gene, this may be fine.</code></pre>
<pre><code>## Warning in function_list[[k]](value): IDs are not unique, this is probably
## bad</code></pre>
<pre><code>##    seqid source                  type start   stop score strand phase
## 1      a  Strex                region     1 230218    NA      +    NA
## 2      a  Strex              telomere     1    801    NA      -    NA
## 3      a  Strex origin_of_replication   707    776    NA      +    NA
## 4      a  Strex                  gene  1807   2169    NA      -    NA
## 5      a  Strex                  mRNA  1807   2169    NA      -    NA
## 6      a  Strex                  exon  1807   2169    NA      -    NA
## 7      a  Strex                   CDS  1807   2169    NA      -     0
## 8      a  Strex                  mRNA  2480   2707    NA      +    NA
## 9      a  Strex                  exon  2480   2707    NA      +    NA
## 10     a  Strex                   CDS  2480   2707    NA      +     0
## 11     b  Strex                  gene  7235   9016    NA      -    NA
## 12     b  Strex                   CDS  7235   9016    NA      -     0
## 13     b  Strex origin_of_replication  7997   8547    NA      +    NA
## 14     b  Strex                  gene 11565  11951    NA      -    NA
## 15     b  Strex                  mRNA 11565  11951    NA      -    NA
## 16     b  Strex                  exon 11565  11951    NA      -    NA
## 17     b  Strex                   CDS 11565  11951    NA      -     0
##       ID Parent
## 1      I   &lt;NA&gt;
## 2    id1   &lt;NA&gt;
## 3    id2   &lt;NA&gt;
## 4  gene1   &lt;NA&gt;
## 5  mrna1  gene1
## 6   &lt;NA&gt;  mrna1
## 7   &lt;NA&gt;  mrna1
## 8  mrna2  gene1
## 9   &lt;NA&gt;  mrna2
## 10  &lt;NA&gt;  mrna2
## 11 gene2   &lt;NA&gt;
## 12  &lt;NA&gt;  gene2
## 13   id6   &lt;NA&gt;
## 14 gene3   &lt;NA&gt;
## 15 mrna3  gene3
## 16  &lt;NA&gt;  mrna3
## 17  &lt;NA&gt;  mrna3</code></pre>
<p>The beauty of this chain is that it requires few temporary variables (just <code>g</code>, and <code>tags</code>), it is a pure flow of data. It is an elegant sequence of functions operating on a single thread of data.</p>
<p>But there are a few problems.</p>
<p>First, it is in dire need of documentation. We could add in comments. But comments cannot be formatted well. A better approach is some form of literate programming, such as rewriting the program in Rmarkdown. But this 1) breaks the pipeline (since we can’t pipe between chunks), 2) results in an object we can’t compute on, 3) makes debugging even more difficult, because our code is spread out.</p>
</div>
<div id="rmonad-approach" class="section level3">
<h3><code>rmonad</code> approach</h3>
<p>With <code>rmonad</code> we can mingle documentation and code in a computable object.</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1"><span class="kw">require</span>(readr)</a>
<a class="sourceLine" id="cb27-2" data-line-number="2"><span class="kw">require</span>(dplyr)</a>
<a class="sourceLine" id="cb27-3" data-line-number="3"><span class="kw">require</span>(tidyr)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4"><span class="kw">require</span>(magrittr)</a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="kw">library</span>(rmonad)</a></code></pre></div>
<pre><code>## 
## Attaching package: 'rmonad'</code></pre>
<pre><code>## The following object is masked from 'package:dplyr':
## 
##     combine</code></pre>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="kw">set.seed</span>(<span class="dv">210</span>)</a>
<a class="sourceLine" id="cb30-2" data-line-number="2"></a>
<a class="sourceLine" id="cb30-3" data-line-number="3"><span class="co">#' @param file The input GFF file</span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4"><span class="co">#' @param tags The GFF tags to keep</span></a>
<a class="sourceLine" id="cb30-5" data-line-number="5"><span class="co">#'        default these are not stored)</span></a>
<a class="sourceLine" id="cb30-6" data-line-number="6">read_gff &lt;-<span class="st"> </span><span class="cf">function</span>(file, tags){</a>
<a class="sourceLine" id="cb30-7" data-line-number="7"></a>
<a class="sourceLine" id="cb30-8" data-line-number="8">  <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-9" data-line-number="9"><span class="st">  This function reads a GFF. It builds a data frame from it that with a column</span></a>
<a class="sourceLine" id="cb30-10" data-line-number="10"><span class="st">  for each value in `tags`.</span></a>
<a class="sourceLine" id="cb30-11" data-line-number="11"></a>
<a class="sourceLine" id="cb30-12" data-line-number="12"><span class="st">  The `read_gff` function is a nested function, containing an Rmonad pipeline</span></a>
<a class="sourceLine" id="cb30-13" data-line-number="13"><span class="st">  inside it. This docstring describes the entire wrapped pipeline.</span></a>
<a class="sourceLine" id="cb30-14" data-line-number="14"><span class="st">  &quot;</span></a>
<a class="sourceLine" id="cb30-15" data-line-number="15"></a>
<a class="sourceLine" id="cb30-16" data-line-number="16">  raw_gff &lt;-<span class="st"> </span><span class="kw">as_monad</span>(</a>
<a class="sourceLine" id="cb30-17" data-line-number="17">    {</a>
<a class="sourceLine" id="cb30-18" data-line-number="18"></a>
<a class="sourceLine" id="cb30-19" data-line-number="19">      <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-20" data-line-number="20"><span class="st">      Rmonad supports docstrings. If a block begins with a string, this</span></a>
<a class="sourceLine" id="cb30-21" data-line-number="21"><span class="st">      string is extracted and stored. Python has something similar, where the</span></a>
<a class="sourceLine" id="cb30-22" data-line-number="22"><span class="st">      first string in a function is cast as documentation.</span></a>
<a class="sourceLine" id="cb30-23" data-line-number="23"><span class="st">      </span></a>
<a class="sourceLine" id="cb30-24" data-line-number="24"><span class="st">      The `as_monad` function takes an expression and wraps its result into a</span></a>
<a class="sourceLine" id="cb30-25" data-line-number="25"><span class="st">      context. It also handles the extraction of this docstring. The result</span></a>
<a class="sourceLine" id="cb30-26" data-line-number="26"><span class="st">      here is used at more than one place in the pipeline. Rather than</span></a>
<a class="sourceLine" id="cb30-27" data-line-number="27"><span class="st">      accessing it later as a global, it will be funneled bach in.</span></a>
<a class="sourceLine" id="cb30-28" data-line-number="28"><span class="st">      &quot;</span></a>
<a class="sourceLine" id="cb30-29" data-line-number="29"></a>
<a class="sourceLine" id="cb30-30" data-line-number="30">      readr<span class="op">::</span><span class="kw">read_tsv</span>(</a>
<a class="sourceLine" id="cb30-31" data-line-number="31">        file,</a>
<a class="sourceLine" id="cb30-32" data-line-number="32">        <span class="dt">col_names =</span> <span class="kw">c</span>(</a>
<a class="sourceLine" id="cb30-33" data-line-number="33">          <span class="st">&quot;seqid&quot;</span>,</a>
<a class="sourceLine" id="cb30-34" data-line-number="34">          <span class="st">&quot;source&quot;</span>,</a>
<a class="sourceLine" id="cb30-35" data-line-number="35">          <span class="st">&quot;type&quot;</span>,</a>
<a class="sourceLine" id="cb30-36" data-line-number="36">          <span class="st">&quot;start&quot;</span>,</a>
<a class="sourceLine" id="cb30-37" data-line-number="37">          <span class="st">&quot;stop&quot;</span>,</a>
<a class="sourceLine" id="cb30-38" data-line-number="38">          <span class="st">&quot;score&quot;</span>,</a>
<a class="sourceLine" id="cb30-39" data-line-number="39">          <span class="st">&quot;strand&quot;</span>,</a>
<a class="sourceLine" id="cb30-40" data-line-number="40">          <span class="st">&quot;phase&quot;</span>,</a>
<a class="sourceLine" id="cb30-41" data-line-number="41">          <span class="st">&quot;attr&quot;</span></a>
<a class="sourceLine" id="cb30-42" data-line-number="42">        ),</a>
<a class="sourceLine" id="cb30-43" data-line-number="43">        <span class="dt">na        =</span> <span class="st">&quot;.&quot;</span>,</a>
<a class="sourceLine" id="cb30-44" data-line-number="44">        <span class="dt">comment   =</span> <span class="st">&quot;#&quot;</span>,</a>
<a class="sourceLine" id="cb30-45" data-line-number="45">        <span class="dt">col_types =</span> <span class="st">&quot;ccciidcic&quot;</span></a>
<a class="sourceLine" id="cb30-46" data-line-number="46">      )</a>
<a class="sourceLine" id="cb30-47" data-line-number="47">    }</a>
<a class="sourceLine" id="cb30-48" data-line-number="48">  )</a>
<a class="sourceLine" id="cb30-49" data-line-number="49"></a>
<a class="sourceLine" id="cb30-50" data-line-number="50">  raw_gff <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">tag</span>(<span class="st">'raw_gff'</span>) <span class="op">%&gt;&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-51" data-line-number="51"></a>
<a class="sourceLine" id="cb30-52" data-line-number="52">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-53" data-line-number="53"><span class="st">    The %&gt;&gt;% operator applies the function described in this block to the</span></a>
<a class="sourceLine" id="cb30-54" data-line-number="54"><span class="st">    input on the left-hand-side. This corresponds to the UNIX '|' or magrittr's</span></a>
<a class="sourceLine" id="cb30-55" data-line-number="55"><span class="st">    '%&gt;%'. It differs from them in that it is a monadic bind operator, rather</span></a>
<a class="sourceLine" id="cb30-56" data-line-number="56"><span class="st">    than an application operator. It carries a context along with the</span></a>
<a class="sourceLine" id="cb30-57" data-line-number="57"><span class="st">    computations. The context can store past values, performance information,</span></a>
<a class="sourceLine" id="cb30-58" data-line-number="58"><span class="st">    this docstring, and links to the parent chunk. The context is a directed</span></a>
<a class="sourceLine" id="cb30-59" data-line-number="59"><span class="st">    graph of code chunks and their metadata.</span></a>
<a class="sourceLine" id="cb30-60" data-line-number="60"></a>
<a class="sourceLine" id="cb30-61" data-line-number="61"><span class="st">    Here I assert that no data is missing in the columns where it is required.</span></a>
<a class="sourceLine" id="cb30-62" data-line-number="62"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-63" data-line-number="63"></a>
<a class="sourceLine" id="cb30-64" data-line-number="64">    <span class="cf">for</span>(col <span class="cf">in</span> <span class="kw">c</span>(<span class="st">&quot;seqid&quot;</span>, <span class="st">&quot;type&quot;</span>, <span class="st">&quot;start&quot;</span>, <span class="st">&quot;stop&quot;</span>)){</a>
<a class="sourceLine" id="cb30-65" data-line-number="65">      <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(.[[col]]))){</a>
<a class="sourceLine" id="cb30-66" data-line-number="66">        <span class="kw">stop</span>(<span class="st">&quot;GFFError: Column '&quot;</span>, col, <span class="st">&quot;' may not have missing values&quot;</span>)</a>
<a class="sourceLine" id="cb30-67" data-line-number="67">      }</a>
<a class="sourceLine" id="cb30-68" data-line-number="68">    }</a>
<a class="sourceLine" id="cb30-69" data-line-number="69">    .</a>
<a class="sourceLine" id="cb30-70" data-line-number="70">  } <span class="op">%&gt;&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-71" data-line-number="71"></a>
<a class="sourceLine" id="cb30-72" data-line-number="72">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-73" data-line-number="73"><span class="st">    According the GFF specification, the value in the type column should be</span></a>
<a class="sourceLine" id="cb30-74" data-line-number="74"><span class="st">    from the Sequence Ontology (SO). Here I collapse the synonymous terms</span></a>
<a class="sourceLine" id="cb30-75" data-line-number="75"><span class="st">    for the main features usually present in GFF file (gene, mRNA, CDS, and</span></a>
<a class="sourceLine" id="cb30-76" data-line-number="76"><span class="st">    exon). In production code, I would probably do something a bit more formal. </span></a>
<a class="sourceLine" id="cb30-77" data-line-number="77"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-78" data-line-number="78"></a>
<a class="sourceLine" id="cb30-79" data-line-number="79">    gene_synonyms &lt;-<span class="st"> 'SO:0000704'</span></a>
<a class="sourceLine" id="cb30-80" data-line-number="80">    mRNA_synonyms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'messenger_RNA'</span>, <span class="st">'messenger RNA'</span>, <span class="st">'SO:0000234'</span>)</a>
<a class="sourceLine" id="cb30-81" data-line-number="81">    CDS_synonyms  &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'coding_sequence'</span>, <span class="st">'coding sequence'</span>, <span class="st">'SO:0000316'</span>)</a>
<a class="sourceLine" id="cb30-82" data-line-number="82">    exon_synonyms &lt;-<span class="st"> 'SO:0000147'</span></a>
<a class="sourceLine" id="cb30-83" data-line-number="83"></a>
<a class="sourceLine" id="cb30-84" data-line-number="84">    .<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>gene_synonyms, <span class="st">'gene'</span>, .<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb30-85" data-line-number="85">    .<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>mRNA_synonyms, <span class="st">'mRNA'</span>, .<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb30-86" data-line-number="86">    .<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>CDS_synonyms,  <span class="st">'CDS'</span>,  .<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb30-87" data-line-number="87">    .<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>exon_synonyms, <span class="st">'exon'</span>, .<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb30-88" data-line-number="88"></a>
<a class="sourceLine" id="cb30-89" data-line-number="89">    .</a>
<a class="sourceLine" id="cb30-90" data-line-number="90">  } <span class="op">%&gt;_%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-91" data-line-number="91"></a>
<a class="sourceLine" id="cb30-92" data-line-number="92">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-93" data-line-number="93"><span class="st">    The %&gt;_% operator lets this chunk of code be run for its effects, which are</span></a>
<a class="sourceLine" id="cb30-94" data-line-number="94"><span class="st">    raising warnings if we replace the type with a questionable synonym.  We</span></a>
<a class="sourceLine" id="cb30-95" data-line-number="95"><span class="st">    could alternatively just use %&gt;&gt;% and add a terminal '.' to this chunk.</span></a>
<a class="sourceLine" id="cb30-96" data-line-number="96"><span class="st">    However, the `%&gt;_%` operator guarantees the input is passed without being</span></a>
<a class="sourceLine" id="cb30-97" data-line-number="97"><span class="st">    changed, which is safer and also clarifies our intention. </span></a>
<a class="sourceLine" id="cb30-98" data-line-number="98"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-99" data-line-number="99"></a>
<a class="sourceLine" id="cb30-100" data-line-number="100">    mRNA_near_synonyms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'transcript'</span>, <span class="st">'SO:0000673'</span>)</a>
<a class="sourceLine" id="cb30-101" data-line-number="101">    exon_near_synonyms &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">'SO:0000147'</span>, <span class="st">'coding_exon'</span>, <span class="st">'coding exon'</span>, <span class="st">'SO:0000195'</span>)</a>
<a class="sourceLine" id="cb30-102" data-line-number="102"></a>
<a class="sourceLine" id="cb30-103" data-line-number="103">    <span class="cf">if</span>(<span class="kw">any</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>mRNA_near_synonyms)){</a>
<a class="sourceLine" id="cb30-104" data-line-number="104">        .<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>mRNA_near_synonyms, <span class="st">'mRNA'</span>, .<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb30-105" data-line-number="105">        <span class="kw">warning</span>(<span class="st">&quot;Substituting transcript types for mRNA types, this is probably OK&quot;</span>)</a>
<a class="sourceLine" id="cb30-106" data-line-number="106">    }</a>
<a class="sourceLine" id="cb30-107" data-line-number="107"></a>
<a class="sourceLine" id="cb30-108" data-line-number="108">    <span class="cf">if</span>(<span class="kw">any</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>exon_near_synonyms)){</a>
<a class="sourceLine" id="cb30-109" data-line-number="109">        .<span class="op">$</span>type &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>type <span class="op">%in%</span><span class="st"> </span>exon_near_synonyms, <span class="st">'exon'</span>, .<span class="op">$</span>type)</a>
<a class="sourceLine" id="cb30-110" data-line-number="110">        <span class="kw">warning</span>(<span class="st">&quot;Substituting transcript types for exon types, this is probably OK&quot;</span>)</a>
<a class="sourceLine" id="cb30-111" data-line-number="111">    }</a>
<a class="sourceLine" id="cb30-112" data-line-number="112"></a>
<a class="sourceLine" id="cb30-113" data-line-number="113">  } <span class="op">%&gt;&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-114" data-line-number="114"></a>
<a class="sourceLine" id="cb30-115" data-line-number="115">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-116" data-line-number="116"><span class="st">    Notice below that I use the magrittr operator '%&gt;%' inside the rmonad</span></a>
<a class="sourceLine" id="cb30-117" data-line-number="117"><span class="st">    pipeline. When to pipe with rmonad and when to pipe with magrittr is a</span></a>
<a class="sourceLine" id="cb30-118" data-line-number="118"><span class="st">    matter of granularity. This chunk of code perhaps should form one</span></a>
<a class="sourceLine" id="cb30-119" data-line-number="119"><span class="st">    documentation unit. And perhaps I don't expect it to fail. If I break this</span></a>
<a class="sourceLine" id="cb30-120" data-line-number="120"><span class="st">    chunk into several, the failures are more localized, and I can access</span></a>
<a class="sourceLine" id="cb30-121" data-line-number="121"><span class="st">    intermediate values for debugging. On the other hand, putting every little</span></a>
<a class="sourceLine" id="cb30-122" data-line-number="122"><span class="st">    operation in a new chunk will clutter the graph and reports derived from</span></a>
<a class="sourceLine" id="cb30-123" data-line-number="123"><span class="st">    it.</span></a>
<a class="sourceLine" id="cb30-124" data-line-number="124"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-125" data-line-number="125"></a>
<a class="sourceLine" id="cb30-126" data-line-number="126">    <span class="kw">data_frame</span>(</a>
<a class="sourceLine" id="cb30-127" data-line-number="127">      <span class="dt">attr  =</span> stringr<span class="op">::</span><span class="kw">str_split</span>(.<span class="op">$</span>attr, <span class="st">&quot;;&quot;</span>),</a>
<a class="sourceLine" id="cb30-128" data-line-number="128">      <span class="dt">order =</span> <span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(.)</a>
<a class="sourceLine" id="cb30-129" data-line-number="129">    ) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-130" data-line-number="130"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ntags =</span> <span class="kw">sapply</span>(attr, length)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-131" data-line-number="131"><span class="st">      </span>tidyr<span class="op">::</span><span class="kw">unnest</span>(attr) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-132" data-line-number="132"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">attr =</span> <span class="kw">ifelse</span>(<span class="kw">grepl</span>(<span class="st">'='</span>, attr), attr, <span class="kw">paste</span>(<span class="st">&quot;.U&quot;</span>, attr, <span class="dt">sep=</span><span class="st">&quot;=&quot;</span>))) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-133" data-line-number="133"><span class="st">      </span>tidyr<span class="op">::</span><span class="kw">separate_</span>(</a>
<a class="sourceLine" id="cb30-134" data-line-number="134">        <span class="dt">col   =</span> <span class="st">&quot;attr&quot;</span>,</a>
<a class="sourceLine" id="cb30-135" data-line-number="135">        <span class="dt">into  =</span> <span class="kw">c</span>(<span class="st">&quot;tag&quot;</span>, <span class="st">&quot;value&quot;</span>),</a>
<a class="sourceLine" id="cb30-136" data-line-number="136">        <span class="dt">sep   =</span> <span class="st">&quot;=&quot;</span>,</a>
<a class="sourceLine" id="cb30-137" data-line-number="137">        <span class="dt">extra =</span> <span class="st">&quot;merge&quot;</span></a>
<a class="sourceLine" id="cb30-138" data-line-number="138">      )</a>
<a class="sourceLine" id="cb30-139" data-line-number="139"></a>
<a class="sourceLine" id="cb30-140" data-line-number="140">   } <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">funnel</span>(<span class="dt">raw_gff=</span>raw_gff, <span class="dt">tags=</span>tags) <span class="op">%*&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-141" data-line-number="141"></a>
<a class="sourceLine" id="cb30-142" data-line-number="142">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-143" data-line-number="143"><span class="st">    The %v&gt;% operator stores the input value in memory. We could replace every</span></a>
<a class="sourceLine" id="cb30-144" data-line-number="144"><span class="st">    %&gt;&gt;% operator with %v&gt;%. This would let us inspect every step of an</span></a>
<a class="sourceLine" id="cb30-145" data-line-number="145"><span class="st">    analysis at the cost of high memory usage. For brevity, I won't break this</span></a>
<a class="sourceLine" id="cb30-146" data-line-number="146"><span class="st">    following block down any further.</span></a>
<a class="sourceLine" id="cb30-147" data-line-number="147"></a>
<a class="sourceLine" id="cb30-148" data-line-number="148"><span class="st">    The `funnel` function packages a list in a monad, merging their histories</span></a>
<a class="sourceLine" id="cb30-149" data-line-number="149"><span class="st">    and propagating error. That is, if `gff` or `tags` failed upstream, this</span></a>
<a class="sourceLine" id="cb30-150" data-line-number="150"><span class="st">    function will not be run. `%*&gt;%` takes a list on the left and feeds it into</span></a>
<a class="sourceLine" id="cb30-151" data-line-number="151"><span class="st">    the function on the right as an argument list. Here `funnel` and `%*&gt;%` are</span></a>
<a class="sourceLine" id="cb30-152" data-line-number="152"><span class="st">    used together to merge a pipeline (gff) and inject a parameter (tags).</span></a>
<a class="sourceLine" id="cb30-153" data-line-number="153"></a>
<a class="sourceLine" id="cb30-154" data-line-number="154"><span class="st">    We could not have written</span></a>
<a class="sourceLine" id="cb30-155" data-line-number="155"></a>
<a class="sourceLine" id="cb30-156" data-line-number="156"><span class="st">      %v&gt;% function(gff=gff, tags=tags)</span></a>
<a class="sourceLine" id="cb30-157" data-line-number="157"></a>
<a class="sourceLine" id="cb30-158" data-line-number="158"><span class="st">    because this would have brought the monad wrapped gff into scope, not the</span></a>
<a class="sourceLine" id="cb30-159" data-line-number="159"><span class="st">    value itself.</span></a>
<a class="sourceLine" id="cb30-160" data-line-number="160"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-161" data-line-number="161"></a>
<a class="sourceLine" id="cb30-162" data-line-number="162">      dplyr<span class="op">::</span><span class="kw">filter</span>(., tag <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(tags, <span class="st">&quot;.U&quot;</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-163" data-line-number="163"><span class="st">      </span>{</a>
<a class="sourceLine" id="cb30-164" data-line-number="164">        <span class="cf">if</span>(<span class="kw">nrow</span>(.) <span class="op">&gt;</span><span class="st"> </span><span class="dv">0</span>){</a>
<a class="sourceLine" id="cb30-165" data-line-number="165">          tidyr<span class="op">::</span><span class="kw">spread</span>(., <span class="dt">key=</span><span class="st">&quot;tag&quot;</span>, <span class="dt">value=</span><span class="st">&quot;value&quot;</span>)</a>
<a class="sourceLine" id="cb30-166" data-line-number="166">        } <span class="cf">else</span> {</a>
<a class="sourceLine" id="cb30-167" data-line-number="167">          .<span class="op">$</span>tag   =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb30-168" data-line-number="168">          .<span class="op">$</span>value =<span class="st"> </span><span class="ot">NULL</span></a>
<a class="sourceLine" id="cb30-169" data-line-number="169">          .</a>
<a class="sourceLine" id="cb30-170" data-line-number="170">        }</a>
<a class="sourceLine" id="cb30-171" data-line-number="171">      } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-172" data-line-number="172"><span class="st">      </span>{</a>
<a class="sourceLine" id="cb30-173" data-line-number="173">        <span class="cf">if</span>(<span class="st">&quot;Parent&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.)){</a>
<a class="sourceLine" id="cb30-174" data-line-number="174">          .<span class="op">$</span>Parent &lt;-<span class="st"> </span><span class="kw">ifelse</span>(.<span class="op">$</span>Parent <span class="op">==</span><span class="st"> &quot;-&quot;</span>, <span class="ot">NA</span>, .<span class="op">$</span>Parent)</a>
<a class="sourceLine" id="cb30-175" data-line-number="175">        }</a>
<a class="sourceLine" id="cb30-176" data-line-number="176">        .</a>
<a class="sourceLine" id="cb30-177" data-line-number="177">      } <span class="op">%&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-178" data-line-number="178">        <span class="cf">for</span>(tag <span class="cf">in</span> <span class="kw">c</span>(tags, <span class="st">&quot;.U&quot;</span>)){</a>
<a class="sourceLine" id="cb30-179" data-line-number="179">          <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span>tag <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.))</a>
<a class="sourceLine" id="cb30-180" data-line-number="180">            .[[tag]] =<span class="st"> </span><span class="ot">NA_character_</span></a>
<a class="sourceLine" id="cb30-181" data-line-number="181">        }</a>
<a class="sourceLine" id="cb30-182" data-line-number="182">        .</a>
<a class="sourceLine" id="cb30-183" data-line-number="183">      } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-184" data-line-number="184"><span class="st">      </span>{</a>
<a class="sourceLine" id="cb30-185" data-line-number="185">        <span class="cf">if</span>(<span class="st">&quot;ID&quot;</span> <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.))</a>
<a class="sourceLine" id="cb30-186" data-line-number="186">          .<span class="op">$</span>ID &lt;-<span class="st"> </span><span class="kw">ifelse</span>(<span class="kw">is.na</span>(.<span class="op">$</span>ID) <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(.<span class="op">$</span>.U) <span class="op">&amp;</span><span class="st"> </span>.<span class="op">$</span>ntags <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, .<span class="op">$</span>.U, .<span class="op">$</span>ID)</a>
<a class="sourceLine" id="cb30-187" data-line-number="187">        .</a>
<a class="sourceLine" id="cb30-188" data-line-number="188">      } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-189" data-line-number="189"><span class="st">      </span><span class="kw">merge</span>(<span class="kw">data_frame</span>(<span class="dt">order=</span><span class="dv">1</span><span class="op">:</span><span class="kw">nrow</span>(raw_gff)), <span class="dt">all=</span><span class="ot">TRUE</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-190" data-line-number="190"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">arrange</span>(order) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-191" data-line-number="191"><span class="st">      </span>{ <span class="kw">cbind</span>(raw_gff, .) } <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-192" data-line-number="192"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>.U, <span class="op">-</span>order, <span class="op">-</span>ntags, <span class="op">-</span>attr)</a>
<a class="sourceLine" id="cb30-193" data-line-number="193"></a>
<a class="sourceLine" id="cb30-194" data-line-number="194">  } <span class="op">%&gt;_%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-195" data-line-number="195"></a>
<a class="sourceLine" id="cb30-196" data-line-number="196">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-197" data-line-number="197"><span class="st">    And make the last few assertions.</span></a>
<a class="sourceLine" id="cb30-198" data-line-number="198"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-199" data-line-number="199"></a>
<a class="sourceLine" id="cb30-200" data-line-number="200">    <span class="cf">if</span>(<span class="kw">all</span>(<span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Parent&quot;</span>) <span class="op">%in%</span><span class="st"> </span><span class="kw">names</span>(.))){</a>
<a class="sourceLine" id="cb30-201" data-line-number="201">      parents &lt;-<span class="st"> </span><span class="kw">subset</span>(., type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CDS&quot;</span>, <span class="st">&quot;exon&quot;</span>))<span class="op">$</span>Parent</a>
<a class="sourceLine" id="cb30-202" data-line-number="202">      parent_types &lt;-<span class="st"> </span><span class="kw">subset</span>(., ID <span class="op">%in%</span><span class="st"> </span>parents)<span class="op">$</span>type</a>
<a class="sourceLine" id="cb30-203" data-line-number="203"></a>
<a class="sourceLine" id="cb30-204" data-line-number="204">      <span class="cf">if</span>(<span class="kw">any</span>(parent_types <span class="op">==</span><span class="st"> &quot;gene&quot;</span>))</a>
<a class="sourceLine" id="cb30-205" data-line-number="205">        <span class="kw">warning</span>(<span class="st">&quot;Found CDS or exon directly inheriting from a gene, this may be fine.&quot;</span>)</a>
<a class="sourceLine" id="cb30-206" data-line-number="206"></a>
<a class="sourceLine" id="cb30-207" data-line-number="207">      <span class="cf">if</span>(<span class="op">!</span><span class="st"> </span><span class="kw">all</span>(parent_types <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;gene&quot;</span>, <span class="st">&quot;mRNA&quot;</span>)))</a>
<a class="sourceLine" id="cb30-208" data-line-number="208">        <span class="kw">stop</span>(<span class="st">&quot;Found CDS or exon with illegal parent&quot;</span>)</a>
<a class="sourceLine" id="cb30-209" data-line-number="209"></a>
<a class="sourceLine" id="cb30-210" data-line-number="210">      <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">is.na</span>(parents)) )</a>
<a class="sourceLine" id="cb30-211" data-line-number="211">        <span class="kw">stop</span>(<span class="st">&quot;Found CDS or exon with no parent&quot;</span>)</a>
<a class="sourceLine" id="cb30-212" data-line-number="212"></a>
<a class="sourceLine" id="cb30-213" data-line-number="213">      <span class="cf">if</span>(<span class="kw">any</span>(<span class="kw">duplicated</span>(.<span class="op">$</span>ID, <span class="dt">incomparables=</span><span class="ot">NA</span>)))</a>
<a class="sourceLine" id="cb30-214" data-line-number="214">        <span class="kw">warning</span>(<span class="st">&quot;IDs are not unique, this is probably bad&quot;</span>)</a>
<a class="sourceLine" id="cb30-215" data-line-number="215">    }</a>
<a class="sourceLine" id="cb30-216" data-line-number="216"></a>
<a class="sourceLine" id="cb30-217" data-line-number="217">  } <span class="op">%&gt;_%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-218" data-line-number="218"></a>
<a class="sourceLine" id="cb30-219" data-line-number="219">    <span class="st">&quot;</span></a>
<a class="sourceLine" id="cb30-220" data-line-number="220"><span class="st">    I could post some closing comments here. The %&gt;_% operator can be chained</span></a>
<a class="sourceLine" id="cb30-221" data-line-number="221"><span class="st">    and the output does not affect the output of the main chain. The NULL is</span></a>
<a class="sourceLine" id="cb30-222" data-line-number="222"><span class="st">    required to distinguish this block from an anonymous function that returns</span></a>
<a class="sourceLine" id="cb30-223" data-line-number="223"><span class="st">    a string.</span></a>
<a class="sourceLine" id="cb30-224" data-line-number="224"><span class="st">    &quot;</span></a>
<a class="sourceLine" id="cb30-225" data-line-number="225"></a>
<a class="sourceLine" id="cb30-226" data-line-number="226">    <span class="ot">NULL</span></a>
<a class="sourceLine" id="cb30-227" data-line-number="227">  }</a>
<a class="sourceLine" id="cb30-228" data-line-number="228">  <span class="co"># End Rmonad chain</span></a>
<a class="sourceLine" id="cb30-229" data-line-number="229"></a>
<a class="sourceLine" id="cb30-230" data-line-number="230">}</a>
<a class="sourceLine" id="cb30-231" data-line-number="231"></a>
<a class="sourceLine" id="cb30-232" data-line-number="232">gff_as_graph &lt;-<span class="st"> </span><span class="cf">function</span>(file){</a>
<a class="sourceLine" id="cb30-233" data-line-number="233">  <span class="kw">read_gff</span>(file, <span class="dt">tags=</span><span class="kw">c</span>(<span class="st">&quot;ID&quot;</span>, <span class="st">&quot;Parent&quot;</span>)) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb30-234" data-line-number="234"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(Parent)) <span class="op">%&gt;&gt;%</span></a>
<a class="sourceLine" id="cb30-235" data-line-number="235"><span class="st">  </span>{</a>
<a class="sourceLine" id="cb30-236" data-line-number="236">      <span class="st">&quot;Make a unique label for each CDS and exon interval&quot;</span></a>
<a class="sourceLine" id="cb30-237" data-line-number="237">      dplyr<span class="op">::</span><span class="kw">group_by</span>(., Parent) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-238" data-line-number="238"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">mutate</span>(<span class="dt">ID =</span> <span class="kw">ifelse</span>(type <span class="op">%in%</span><span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;CDS&quot;</span>, <span class="st">&quot;exon&quot;</span>),</a>
<a class="sourceLine" id="cb30-239" data-line-number="239">                                <span class="kw">paste</span>(type, start, <span class="dt">sep=</span><span class="st">'-'</span>),</a>
<a class="sourceLine" id="cb30-240" data-line-number="240">                                ID)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-241" data-line-number="241"><span class="st">      </span>dplyr<span class="op">::</span><span class="kw">ungroup</span>()</a>
<a class="sourceLine" id="cb30-242" data-line-number="242">  } <span class="op">%&gt;&gt;%</span><span class="st"> </span>{</a>
<a class="sourceLine" id="cb30-243" data-line-number="243">    <span class="st">&quot;Make a graph of gene models&quot;</span></a>
<a class="sourceLine" id="cb30-244" data-line-number="244">    dplyr<span class="op">::</span><span class="kw">select</span>(., ID, Parent) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-245" data-line-number="245"><span class="st">      </span>as.matrix <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb30-246" data-line-number="246"><span class="st">      </span>igraph<span class="op">::</span><span class="kw">graph_from_edgelist</span>()</a>
<a class="sourceLine" id="cb30-247" data-line-number="247">  }</a>
<a class="sourceLine" id="cb30-248" data-line-number="248">}</a></code></pre></div>
<p>That is the whole GFF program in an rmonad framework</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">result &lt;-</a>
<a class="sourceLine" id="cb31-2" data-line-number="2"><span class="st">  </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'gff'</span>, <span class="st">'0.gff3'</span>, <span class="dt">package=</span><span class="st">'rmonad'</span>) <span class="op">%v&gt;%</span><span class="st"> </span>gff_as_graph</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">result <span class="op">%&gt;%</span><span class="st"> </span>plot</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p><code>esc</code> will extract the final result, and raise all errors, warnings and messages that where extracted</p>
<div class="sourceCode" id="cb32"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb32-1" data-line-number="1"><span class="kw">esc</span>(result)</a></code></pre></div>
<pre><code>## Warning: in 'function (.) 
## {
##     if (all(c(&quot;ID&quot;, &quot;Parent&quot;) %in% names(.))) {
##         parents &lt;- subset(., type %in% c(&quot;CDS&quot;, &quot;exon&quot;))$Parent
##         parent_types &lt;- subset(., ID %in% parents)$type
##         if (any(parent_types == &quot;gene&quot;)) 
##             warning(&quot;Found CDS or exon directly inheriting from a gene, this may be fine.&quot;)
##         if (!all(parent_types %in% c(&quot;gene&quot;, &quot;mRNA&quot;))) 
##             stop(&quot;Found CDS or exon with illegal parent&quot;)
##         if (any(is.na(parents))) 
##             stop(&quot;Found CDS or exon with no parent&quot;)
##         if (any(duplicated(.$ID, incomparables = NA))) 
##             warning(&quot;IDs are not unique, this is probably bad&quot;)
##     }
## }': Found CDS or exon directly inheriting from a gene, this may be fine.</code></pre>
<pre><code>## IGRAPH b3c24fe DN-- 13 10 -- 
## + attr: name (v/c)
## + edges from b3c24fe (vertex names):
##  [1] mrna1     -&gt;gene1 exon-1807 -&gt;mrna1 CDS-1807  -&gt;mrna1
##  [4] mrna2     -&gt;gene1 exon-2480 -&gt;mrna2 CDS-2480  -&gt;mrna2
##  [7] CDS-7235  -&gt;gene2 mrna3     -&gt;gene3 exon-11565-&gt;mrna3
## [10] CDS-11565 -&gt;mrna3</code></pre>
<p>Now we see why we might want a little more granularity in our pipeline. To summarize the results we can use the <code>mtabulate</code> functions.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" data-line-number="1"><span class="kw">mtabulate</span>(result)</a></code></pre></div>
<pre><code>##    id   OK cached  time space is_nested ndependents nnotes nwarnings error
## 1   1 TRUE   TRUE 0.003   152         0           1      0         0     0
## 2   2 TRUE  FALSE 0.003   152         0           1      0         0     0
## 3   3 TRUE   TRUE 0.003  9216         0           2      0         0     0
## 4   4 TRUE  FALSE 0.003  9216         0           1      0         0     0
## 5   5 TRUE  FALSE 0.003  9216         0           1      0         0     0
## 6   6 TRUE  FALSE 0.003  9216         0           1      0         0     0
## 7   7 TRUE  FALSE 0.003  2256         0           1      0         0     0
## 8   8 TRUE  FALSE 0.003 12024         0           1      0         0     0
## 9   9 TRUE  FALSE 0.003  4416         0           1      0         0     0
## 10 10 TRUE  FALSE 0.003  4416         0           1      0         1     0
## 11 11 TRUE  FALSE 0.003  4416         0           1      0         0     0
## 12 12 TRUE  FALSE 0.003  3560         0           1      0         0     0
## 13 13 TRUE  FALSE 0.003  4072         0           1      0         0     0
## 14 14 TRUE  FALSE 0.003  3016         0           0      0         0     0
## 15 15 TRUE   TRUE 0.003  3016         1           0      0         0     0
##    doc
## 1    0
## 2    0
## 3    1
## 4    1
## 5    1
## 6    1
## 7    1
## 8    0
## 9    1
## 10   1
## 11   1
## 12   0
## 13   1
## 14   1
## 15   0</code></pre>
<p>We can also get a summary of issues</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" data-line-number="1"><span class="kw">missues</span>(result)</a></code></pre></div>
<pre><code>##   id    type
## 1 10 warning
##                                                                  issue
## 1 Found CDS or exon directly inheriting from a gene, this may be fine.</code></pre>
<p>The <code>id</code> column corresponds to a row number in the <code>mtabulate</code> result.</p>
<p>To extract particular values, we can use the <code>get_*</code> family of vectorized getters</p>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" data-line-number="1"><span class="co"># get a list of every stored value, report uncached values as NULL</span></a>
<a class="sourceLine" id="cb39-2" data-line-number="2"><span class="kw">get_value</span>(result, <span class="dt">warn=</span><span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb39-3" data-line-number="3"><span class="co"># get a list of every docstring</span></a>
<a class="sourceLine" id="cb39-4" data-line-number="4"><span class="kw">get_doc</span>(result)</a></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" data-line-number="1"><span class="kw">plot</span>(result)</a></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>A plot of the connections between functions in the pipeline. The node labels are the <code>rmonad</code> ids. The red arrow indicates a ‘nest’ relationship. Green nodes are OK, orange nodes raised a warning, red nodes (none appear in this graph) represent errors.</p>
<p>If the pipeline fails, the last valid result is saved, for example</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" data-line-number="1">m &lt;-</a>
<a class="sourceLine" id="cb41-2" data-line-number="2"><span class="st">  </span><span class="kw">system.file</span>(<span class="st">'extdata'</span>, <span class="st">'gff'</span>, <span class="st">'15.gff3'</span>, <span class="dt">package=</span><span class="st">'rmonad'</span>) <span class="op">%v&gt;%</span></a>
<a class="sourceLine" id="cb41-3" data-line-number="3"><span class="st">  </span>gff_as_graph</a></code></pre></div>
<p>To diagnose the problem, we might first read the error messages:</p>
<div class="sourceCode" id="cb42"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb42-1" data-line-number="1"><span class="kw">get_error</span>(m)</a></code></pre></div>
<pre><code>## [[1]]
## character(0)
## 
## [[2]]
## character(0)
## 
## [[3]]
## character(0)
## 
## [[4]]
## [1] &quot;GFFError: Column 'type' may not have missing values&quot;
## 
## [[5]]
## character(0)
## 
## [[6]]
## character(0)</code></pre>
<p>Here we see the 4th node raised an error: we having missing values in the ‘type’ column.</p>
<p>To get a big picture of the pipeline:</p>
<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" data-line-number="1"><span class="kw">mtabulate</span>(m)</a></code></pre></div>
<pre><code>##   id    OK cached  time space is_nested ndependents nnotes nwarnings error
## 1  1  TRUE   TRUE 0.004   152         0           1      0         0     0
## 2  2  TRUE  FALSE 0.004   152         0           1      0         0     0
## 3  3  TRUE   TRUE 0.004 15712         0           2      0         2     0
## 4  4 FALSE   TRUE 0.004 15712         0           1      0         0     1
## 5  5 FALSE   TRUE 0.004 16264         0           0      0         0     0
## 6  6 FALSE   TRUE 0.004   152         1           0      0         0     0
##   doc
## 1   0
## 2   0
## 3   1
## 4   1
## 5   1
## 6   0</code></pre>
<p>The the last three nodes are in the failing state (see column ‘OK’). We can see all issues:</p>
<div class="sourceCode" id="cb46"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb46-1" data-line-number="1"><span class="kw">missues</span>(m)</a></code></pre></div>
<pre><code>##   id    type
## 1  4   error
## 2  3 warning
## 3  3 warning
##                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     issue
## 1                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     GFFError: Column 'type' may not have missing values
## 2                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  number of columns of result is not a multiple of vector length (arg 1)
## 3 41 parsing failures.\nrow # A tibble: 5 x 5 col     row col   expected  actual    file                                     expected   &lt;int&gt; &lt;chr&gt; &lt;chr&gt;     &lt;chr&gt;     &lt;chr&gt;                                    actual 1    13 &lt;NA&gt;  9 columns 1 columns '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmon… file 2    14 &lt;NA&gt;  9 columns 1 columns '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmon… row 3    15 &lt;NA&gt;  9 columns 1 columns '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmon… col 4    16 &lt;NA&gt;  9 columns 1 columns '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmon… expected 5    17 &lt;NA&gt;  9 columns 1 columns '/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmon…\n... ................. ... .......................................................................... ........ .......................................................................... ...... .......................................................................... .... .......................................................................... ... .......................................................................... ... .......................................................................... ........ ..........................................................................\nSee problems(...) for more details.\n</code></pre>
<p>We see two warnings in node 3. To see what code is wrapped in node 3:</p>
<div class="sourceCode" id="cb48"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb48-1" data-line-number="1"><span class="kw">get_code</span>(m, <span class="dv">3</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;{&quot;                                                                         
## [2] &quot;    readr::read_tsv(file, col_names = c(\&quot;seqid\&quot;, \&quot;source\&quot;, \&quot;type\&quot;, &quot; 
## [3] &quot;        \&quot;start\&quot;, \&quot;stop\&quot;, \&quot;score\&quot;, \&quot;strand\&quot;, \&quot;phase\&quot;, \&quot;attr\&quot;), &quot;
## [4] &quot;        na = \&quot;.\&quot;, comment = \&quot;#\&quot;, col_types = \&quot;ccciidcic\&quot;)&quot;           
## [5] &quot;}&quot;</code></pre>
<p>So there were issues in reading the file. We can get the value of this node’s parent:</p>
<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" data-line-number="1"><span class="kw">get_value</span>(m, <span class="kw">get_parents</span>(m, <span class="dv">3</span>)[[<span class="dv">1</span>]])[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## [1] &quot;/tmp/Rtmp2WTJss/Rinst302a77fda55d/rmonad/extdata/gff/15.gff3&quot;</code></pre>
<p>If we wanted to explore the raw data, we could jump into a Bash shell, navigate to the file above, and take it apart with UNIX tools (the lines of raw data were not stored in the Rmonad object).</p>
<p>We might next check out the failing columns:</p>
<div class="sourceCode" id="cb52"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb52-1" data-line-number="1"><span class="kw">get_code</span>(m, <span class="dv">4</span><span class="op">:</span><span class="dv">6</span>)</a></code></pre></div>
<pre><code>## [[1]]
## [1] &quot;function (.) &quot;                                                                   
## [2] &quot;{&quot;                                                                               
## [3] &quot;    for (col in c(\&quot;seqid\&quot;, \&quot;type\&quot;, \&quot;start\&quot;, \&quot;stop\&quot;)) {&quot;                  
## [4] &quot;        if (any(is.na(.[[col]]))) {&quot;                                             
## [5] &quot;            stop(\&quot;GFFError: Column '\&quot;, col, \&quot;' may not have missing values\&quot;)&quot;
## [6] &quot;        }&quot;                                                                       
## [7] &quot;    }&quot;                                                                           
## [8] &quot;    .&quot;                                                                           
## [9] &quot;}&quot;                                                                               
## 
## [[2]]
## [1] &quot;funnel(., raw_gff = raw_gff, tags = tags)&quot;
## 
## [[3]]
## [1] &quot;gff_as_graph&quot;</code></pre>
<p>Now that we know exactly <em>where</em> the problem is, we can start working through the data that triggered the problem:</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" data-line-number="1"><span class="kw">get_value</span>(m, <span class="kw">get_parents</span>(m, <span class="dv">5</span>)[[<span class="dv">1</span>]])</a></code></pre></div>
<pre><code>## Warning in v@get(warn): Attempting to access data that has been deleted,
## returning 'NULL'</code></pre>
<pre><code>## [[1]]
## NULL
## 
## [[2]]
## # A tibble: 53 x 9
##    seqid  source type            start  stop     score strand phase attr  
##    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt; 
##  1 ctg123 &lt;NA&gt;   gene              100   900 NA        +         NA ID=ge…
##  2 ctg123 &lt;NA&gt;   TF_binding_site   110   121 NA        +         NA ID=tf…
##  3 ctg123 &lt;NA&gt;   mRNA              205   900 NA        +         NA ID=mR…
##  4 ctg123 &lt;NA&gt;   five_prime_UTR    205   220 NA        +         NA Paren…
##  5 ctg123 &lt;NA&gt;   CDS               221   350 NA        +          0 ID=cd…
##  6 ctg123 &lt;NA&gt;   CDS               400   444 NA        +          0 ID=cd…
##  7 ctg123 &lt;NA&gt;   CDS               500   550 NA        +          0 ID=cd…
##  8 ctg123 &lt;NA&gt;   CDS               700   760 NA        +          0 ID=cd…
##  9 ctg123 &lt;NA&gt;   three_prime_UTR   761   900 NA        +         NA Paren…
## 10 ctg123 &lt;NA&gt;   cDNA_match        105   150  5.80e-42 +         NA ID=ma…
## # ... with 43 more rows
## 
## [[3]]
## # A tibble: 53 x 9
##    seqid  source type            start  stop     score strand phase attr  
##    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt; 
##  1 ctg123 &lt;NA&gt;   gene              100   900 NA        +         NA ID=ge…
##  2 ctg123 &lt;NA&gt;   TF_binding_site   110   121 NA        +         NA ID=tf…
##  3 ctg123 &lt;NA&gt;   mRNA              205   900 NA        +         NA ID=mR…
##  4 ctg123 &lt;NA&gt;   five_prime_UTR    205   220 NA        +         NA Paren…
##  5 ctg123 &lt;NA&gt;   CDS               221   350 NA        +          0 ID=cd…
##  6 ctg123 &lt;NA&gt;   CDS               400   444 NA        +          0 ID=cd…
##  7 ctg123 &lt;NA&gt;   CDS               500   550 NA        +          0 ID=cd…
##  8 ctg123 &lt;NA&gt;   CDS               700   760 NA        +          0 ID=cd…
##  9 ctg123 &lt;NA&gt;   three_prime_UTR   761   900 NA        +         NA Paren…
## 10 ctg123 &lt;NA&gt;   cDNA_match        105   150  5.80e-42 +         NA ID=ma…
## # ... with 43 more rows</code></pre>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" data-line-number="1"><span class="kw">get_value</span>(m, <span class="dv">5</span>)[[<span class="dv">1</span>]]</a></code></pre></div>
<pre><code>## [[1]]
## NULL
## 
## $raw_gff
## # A tibble: 53 x 9
##    seqid  source type            start  stop     score strand phase attr  
##    &lt;chr&gt;  &lt;chr&gt;  &lt;chr&gt;           &lt;int&gt; &lt;int&gt;     &lt;dbl&gt; &lt;chr&gt;  &lt;int&gt; &lt;chr&gt; 
##  1 ctg123 &lt;NA&gt;   gene              100   900 NA        +         NA ID=ge…
##  2 ctg123 &lt;NA&gt;   TF_binding_site   110   121 NA        +         NA ID=tf…
##  3 ctg123 &lt;NA&gt;   mRNA              205   900 NA        +         NA ID=mR…
##  4 ctg123 &lt;NA&gt;   five_prime_UTR    205   220 NA        +         NA Paren…
##  5 ctg123 &lt;NA&gt;   CDS               221   350 NA        +          0 ID=cd…
##  6 ctg123 &lt;NA&gt;   CDS               400   444 NA        +          0 ID=cd…
##  7 ctg123 &lt;NA&gt;   CDS               500   550 NA        +          0 ID=cd…
##  8 ctg123 &lt;NA&gt;   CDS               700   760 NA        +          0 ID=cd…
##  9 ctg123 &lt;NA&gt;   three_prime_UTR   761   900 NA        +         NA Paren…
## 10 ctg123 &lt;NA&gt;   cDNA_match        105   150  5.80e-42 +         NA ID=ma…
## # ... with 43 more rows
## 
## $tags
## [1] &quot;ID&quot;     &quot;Parent&quot;</code></pre>
<p>From this it looks like there is raw sequence data contained in the GFF file. According to the GFF specification, it is legal to have the full sequence data appended to the tabular GFF data. So we probably should either add a test that will raise an appropriate error message or extend our function to handle this case.</p>
<p><code>rmonad</code> saved the input to the failing function. This makes debugging much simpler. We did not have to disassemble our pipeline and rerun it step-by-step.</p>
<p>Overall, in <code>rmonad</code>, the output of a pipeline is not just the effluent of the last node, but the collection of all the nodes along the way. The pipeline itself becomes data that can be computed upon.</p>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
